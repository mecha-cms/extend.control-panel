!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function r(e){for(var r=0;r<e.state.activeLines.length;r++)e.removeLineClass(e.state.activeLines[r],"wrap",t),e.removeLineClass(e.state.activeLines[r],"background",i),e.removeLineClass(e.state.activeLines[r],"gutter",n)}function a(e,t){if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}function o(e,o){for(var s=[],f=0;f<o.length;f++){var l=o[f],c=e.getOption("styleActiveLine");if("object"==typeof c&&c.nonEmpty?l.anchor.line==l.head.line:l.empty()){var v=e.getLineHandleVisualStart(l.head.line);s[s.length-1]!=v&&s.push(v)}}a(e.state.activeLines,s)||e.operation(function(){r(e);for(var a=0;a<s.length;a++)e.addLineClass(s[a],"wrap",t),e.addLineClass(s[a],"background",i),e.addLineClass(s[a],"gutter",n);e.state.activeLines=s})}function s(e,t){o(e,t.ranges)}var t="CodeMirror-activeline",i="CodeMirror-activeline-background",n="CodeMirror-activeline-gutter";e.defineOption("styleActiveLine",!1,function(t,i,n){var a=n==e.Init?!1:n;i!=a&&(a&&(t.off("beforeSelectionChange",s),r(t),delete t.state.activeLines),i&&(t.state.activeLines=[],o(t,t.listSelections()),t.on("beforeSelectionChange",s)))})});