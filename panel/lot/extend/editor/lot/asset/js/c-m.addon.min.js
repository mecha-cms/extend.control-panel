!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,r){var n,i=e.getWrapperElement();return n=i.appendChild(document.createElement("div")),r?n.className="CodeMirror-dialog CodeMirror-dialog-bottom":n.className="CodeMirror-dialog CodeMirror-dialog-top","string"==typeof t?n.innerHTML=t:n.appendChild(t),n}function r(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}e.defineExtension("openDialog",function(i,n,a){function u(e){if("string"==typeof e)c.value=e;else{if(l)return;l=!0,o.parentNode.removeChild(o),s.focus(),a.onClose&&a.onClose(o)}}a||(a={}),r(this,null);var f,o=t(this,i,a.bottom),l=!1,s=this,c=o.getElementsByTagName("input")[0];return c?(c.focus(),a.value&&(c.value=a.value,a.selectValueOnOpen!==!1&&c.select()),a.onInput&&e.on(c,"input",function(e){a.onInput(e,c.value,u)}),a.onKeyUp&&e.on(c,"keyup",function(e){a.onKeyUp(e,c.value,u)}),e.on(c,"keydown",function(t){a&&a.onKeyDown&&a.onKeyDown(t,c.value,u)||((27==t.keyCode||a.closeOnEnter!==!1&&13==t.keyCode)&&(c.blur(),e.e_stop(t),u()),13==t.keyCode&&n(c.value,t))}),a.closeOnBlur!==!1&&e.on(c,"blur",u)):(f=o.getElementsByTagName("button")[0])&&(e.on(f,"click",function(){u(),s.focus()}),a.closeOnBlur!==!1&&e.on(f,"blur",u),f.focus()),u}),e.defineExtension("openConfirm",function(i,n,a){function f(){s||(s=!0,o.parentNode.removeChild(o),u.focus())}r(this,null);var o=t(this,i,a&&a.bottom),l=o.getElementsByTagName("button"),s=!1,u=this,c=1;l[0].focus();for(var d=0;d<l.length;++d){var p=l[d];!function(t){e.on(p,"click",function(r){e.e_preventDefault(r),f(),t&&t(u)})}(n[d]),e.on(p,"blur",function(){--c,setTimeout(function(){0>=c&&f()},200)}),e.on(p,"focus",function(){++c})}}),e.defineExtension("openNotification",function(i,n){function u(){o||(o=!0,clearTimeout(l),a.parentNode.removeChild(a))}r(this,u);var l,a=t(this,i,n&&n.bottom),o=!1,s=n&&"undefined"!=typeof n.duration?n.duration:5e3;return e.on(a,"click",function(t){e.e_preventDefault(t),u()}),s&&(l=setTimeout(u,s)),u})});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","brace",function(t,r){function a(a){for(var l=r.ch,s=0;;){var c=0>=l?-1:n.lastIndexOf(a,l-1);if(-1!=c){if(1==s&&c<r.ch)break;if(o=t.getTokenTypeAt(e.Pos(i,c+1)),!/^(comment|string)/.test(o))return c+1;l=c-1}else{if(1==s)break;s=1,l=n.length}}}var o,i=r.line,n=t.getLine(i),l="{",s="}",c=a("{");if(null==c&&(l="[",s="]",c=a("[")),null!=c){var d,p,u=1,f=t.lastLine();e:for(var h=i;f>=h;++h)for(var m=t.getLine(h),g=h==i?c:0;;){var v=m.indexOf(l,g),y=m.indexOf(s,g);if(0>v&&(v=m.length),0>y&&(y=m.length),g=Math.min(v,y),g==m.length)break;if(t.getTokenTypeAt(e.Pos(h,g+1))==o)if(g==v)++u;else if(!--u){d=h,p=g;break e}++g}if(null!=d&&(i!=d||p!=c))return{from:e.Pos(i,c),to:e.Pos(d,p)}}}),e.registerHelper("fold","import",function(t,r){function i(r){if(r<t.firstLine()||r>t.lastLine())return null;var i=t.getTokenAt(e.Pos(r,1));if(/\S/.test(i.string)||(i=t.getTokenAt(e.Pos(r,i.end+1))),"keyword"!=i.type||"import"!=i.string)return null;for(var n=r,o=Math.min(t.lastLine(),r+10);o>=n;++n){var a=t.getLine(n),l=a.indexOf(";");if(-1!=l)return{startCh:i.end,end:e.Pos(n,l)}}}var a,n=r.line,o=i(n);if(!o||i(n-1)||(a=i(n-2))&&a.end.line==n-1)return null;for(var l=o.end;;){var s=i(l.line+1);if(null==s)break;l=s.end}return{from:t.clipPos(e.Pos(n,o.startCh+1)),to:l}}),e.registerHelper("fold","include",function(t,r){function i(r){if(r<t.firstLine()||r>t.lastLine())return null;var i=t.getTokenAt(e.Pos(r,1));return/\S/.test(i.string)||(i=t.getTokenAt(e.Pos(r,i.end+1))),"meta"==i.type&&"#include"==i.string.slice(0,8)?i.start+8:void 0}var n=r.line,o=i(n);if(null==o||null!=i(n-1))return null;for(var a=n;;){var l=i(a+1);if(null==l)break;++a}return{from:e.Pos(n,o+1),to:t.clipPos(e.Pos(a))}})});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,r){var i=t.getLine(r),n=i.search(/\S/);return-1==n||/\bcomment\b/.test(t.getTokenTypeAt(e.Pos(r,n+1)))?-1:e.countColumn(i,null,t.getOption("tabSize"))}e.registerHelper("fold","indent",function(r,i){var n=t(r,i.line);if(!(0>n)){for(var o=null,a=i.line+1,l=r.lastLine();l>=a;++a){var s=t(r,a);if(-1==s);else{if(!(s>n))break;o=a}}return o?{from:e.Pos(i.line,r.getLine(i.line).length),to:e.Pos(o,r.getLine(o).length)}:void 0}})});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.registerHelper("fold","markdown",function(t,r){function n(r){var i=t.getTokenTypeAt(e.Pos(r,0));return i&&/\bheader\b/.test(i)}function o(e,t,r){var o=t&&t.match(/^#+/);return o&&n(e)?o[0].length:(o=r&&r.match(/^[=\-]+\s*$/),o&&n(e+1)?"="==r[0]?1:2:i)}var i=100,a=t.getLine(r.line),l=t.getLine(r.line+1),s=o(r.line,a,l);if(s===i)return void 0;for(var c=t.lastLine(),u=r.line,f=t.getLine(u+2);c>u&&!(o(u+1,l,f)<=s);)++u,l=f,f=t.getLine(u+2);return{from:e.Pos(r.line,a.length),to:e.Pos(u,t.getLine(u).length)}})});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function r(e,t){return e.line-t.line||e.ch-t.ch}function a(e,t,r,i){this.line=t,this.ch=r,this.cm=e,this.text=e.getLine(t),this.min=i?Math.max(i.from,e.firstLine()):e.firstLine(),this.max=i?Math.min(i.to-1,e.lastLine()):e.lastLine()}function l(e,r){var i=e.cm.getTokenTypeAt(t(e.line,r));return i&&/\btag\b/.test(i)}function s(e){return e.line>=e.max?void 0:(e.ch=0,e.text=e.cm.getLine(++e.line),!0)}function c(e){return e.line<=e.min?void 0:(e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0)}function u(e){for(;;){var t=e.text.indexOf(">",e.ch);if(-1==t){if(s(e))continue;return}{if(l(e,t+1)){var r=e.text.lastIndexOf("/",t),i=r>-1&&!/\S/.test(e.text.slice(r+1,t));return e.ch=t+1,i?"selfClose":"regular"}e.ch=t+1}}}function f(e){for(;;){var t=e.ch?e.text.lastIndexOf("<",e.ch-1):-1;if(-1==t){if(c(e))continue;return}if(l(e,t+1)){o.lastIndex=t,e.ch=t;var r=o.exec(e.text);if(r&&r.index==t)return r}else e.ch=t}}function d(e){for(;;){o.lastIndex=e.ch;var t=o.exec(e.text);if(!t){if(s(e))continue;return}{if(l(e,t.index+1))return e.ch=t.index+t[0].length,t;e.ch=t.index+1}}}function p(e){for(;;){var t=e.ch?e.text.lastIndexOf(">",e.ch-1):-1;if(-1==t){if(c(e))continue;return}{if(l(e,t+1)){var r=e.text.lastIndexOf("/",t),i=r>-1&&!/\S/.test(e.text.slice(r+1,t));return e.ch=t+1,i?"selfClose":"regular"}e.ch=t}}}function m(e,r){for(var i=[];;){var o,n=d(e),a=e.line,l=e.ch-(n?n[0].length:0);if(!n||!(o=u(e)))return;if("selfClose"!=o)if(n[1]){for(var s=i.length-1;s>=0;--s)if(i[s]==n[2]){i.length=s;break}if(0>s&&(!r||r==n[2]))return{tag:n[2],from:t(a,l),to:t(e.line,e.ch)}}else i.push(n[2])}}function h(e,r){for(var i=[];;){var n=p(e);if(!n)return;if("selfClose"!=n){var o=e.line,a=e.ch,l=f(e);if(!l)return;if(l[1])i.push(l[2]);else{for(var s=i.length-1;s>=0;--s)if(i[s]==l[2]){i.length=s;break}if(0>s&&(!r||r==l[2]))return{tag:l[2],from:t(e.line,e.ch),to:t(o,a)}}}else f(e)}}var t=e.Pos,i="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",n=i+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",o=new RegExp("<(/?)(["+i+"]["+n+"]*)","g");e.registerHelper("fold","xml",function(e,r){for(var i=new a(e,r.line,0);;){var o,n=d(i);if(!n||i.line!=r.line||!(o=u(i)))return;if(!n[1]&&"selfClose"!=o){var l=t(i.line,i.ch),s=m(i,n[2]);return s&&{from:l,to:s.from}}}}),e.findMatchingTag=function(e,i,n){var o=new a(e,i.line,i.ch,n);if(-1!=o.text.indexOf(">")||-1!=o.text.indexOf("<")){var l=u(o),s=l&&t(o.line,o.ch),c=l&&f(o);if(l&&c&&!(r(o,i)>0)){var d={from:t(o.line,o.ch),to:s,tag:c[2]};return"selfClose"==l?{open:d,close:null,at:"open"}:c[1]?{open:h(o,c[2]),close:d,at:"close"}:(o=new a(e,s.line,s.ch,n),{open:d,close:m(o,c[2]),at:"open"})}}},e.findEnclosingTag=function(e,t,r,i){for(var n=new a(e,t.line,t.ch,r);;){var o=h(n,i);if(!o)break;var l=new a(e,t.line,t.ch,r),s=m(l,o.tag);if(s)return{open:o,close:s}}},e.scanForClosingTag=function(e,t,r,i){var n=new a(e,t.line,t.ch,i?{from:0,to:i}:null);return m(n,r)}});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.overlayMode=function(t,n,r){return{startState:function(){return{base:e.startState(t),overlay:e.startState(n),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(r){return{base:e.copyState(t,r.base),overlay:e.copyState(n,r.overlay),basePos:r.basePos,baseCur:null,overlayPos:r.overlayPos,overlayCur:null}},token:function(e,a){return(e!=a.streamSeen||Math.min(a.basePos,a.overlayPos)<e.start)&&(a.streamSeen=e,a.basePos=a.overlayPos=e.start),e.start==a.basePos&&(a.baseCur=t.token(e,a.base),a.basePos=e.pos),e.start==a.overlayPos&&(e.pos=e.start,a.overlayCur=n.token(e,a.overlay),a.overlayPos=e.pos),e.pos=Math.min(a.basePos,a.overlayPos),null==a.overlayCur?a.baseCur:null!=a.baseCur&&a.overlay.combineTokens||r&&null==a.overlay.combineTokens?a.baseCur+" "+a.overlayCur:a.overlayCur},indent:t.indent&&function(e,n){return t.indent(e.base,n)},electricChars:t.electricChars,innerMode:function(e){return{state:e.base,mode:t}},blankLine:function(e){var a,o;return t.blankLine&&(a=t.blankLine(e.base)),n.blankLine&&(o=n.blankLine(e.overlay)),null==o?a:r&&null!=a?a+" "+o:o}}}});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){if(!e.hasOwnProperty(t))throw new Error("Undefined state "+t+" in simple mode")}function n(e,t){if(!e)return/(?:)/;var n="";return e instanceof RegExp?(e.ignoreCase&&(n="i"),e=e.source):e=String(e),new RegExp((t===!1?"":"^")+"(?:"+e+")",n)}function r(e){if(!e)return null;if(e.apply)return e;if("string"==typeof e)return e.replace(/\./g," ");for(var t=[],n=0;n<e.length;n++)t.push(e[n]&&e[n].replace(/\./g," "));return t}function a(e,a){(e.next||e.push)&&t(a,e.next||e.push),this.regex=n(e.regex),this.token=r(e.token),this.data=e}function o(e,t){return function(n,r){if(r.pending){var a=r.pending.shift();return 0==r.pending.length&&(r.pending=null),n.pos+=a.text.length,a.token}if(r.local){if(r.local.end&&n.match(r.local.end)){var o=r.local.endToken||null;return r.local=r.localState=null,o}var i,o=r.local.mode.token(n,r.localState);return r.local.endScan&&(i=r.local.endScan.exec(n.current()))&&(n.pos=n.start+i.index),o}for(var l=e[r.state],f=0;f<l.length;f++){var u=l[f],c=(!u.data.sol||n.sol())&&n.match(u.regex);if(c){u.data.next?r.state=u.data.next:u.data.push?((r.stack||(r.stack=[])).push(r.state),r.state=u.data.push):u.data.pop&&r.stack&&r.stack.length&&(r.state=r.stack.pop()),u.data.mode&&s(t,r,u.data.mode,u.token),u.data.indent&&r.indent.push(n.indentation()+t.indentUnit),u.data.dedent&&r.indent.pop();var d=u.token;if(d&&d.apply&&(d=d(c)),c.length>2){r.pending=[];for(var m=2;m<c.length;m++)c[m]&&r.pending.push({text:c[m],token:u.token[m-1]});return n.backUp(c[0].length-(c[1]?c[1].length:0)),d[0]}return d&&d.join?d[0]:d}}return n.next(),null}}function i(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;var n=0;for(var r in e)if(e.hasOwnProperty(r)){if(!t.hasOwnProperty(r)||!i(e[r],t[r]))return!1;n++}for(var r in t)t.hasOwnProperty(r)&&n--;return 0==n}function s(t,r,a,o){var s;if(a.persistent)for(var l=r.persistentStates;l&&!s;l=l.next)(a.spec?i(a.spec,l.spec):a.mode==l.mode)&&(s=l);var f=s?s.mode:a.mode||e.getMode(t,a.spec),u=s?s.state:e.startState(f);a.persistent&&!s&&(r.persistentStates={mode:f,spec:a.spec,state:u,next:r.persistentStates}),r.localState=u,r.local={mode:f,end:a.end&&n(a.end),endScan:a.end&&a.forceEnd!==!1&&n(a.end,!1),endToken:o&&o.join?o[o.length-1]:o}}function l(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return!0}function f(t,n){return function(r,a,o){if(r.local&&r.local.mode.indent)return r.local.mode.indent(r.localState,a,o);if(null==r.indent||r.local||n.dontIndentStates&&l(r.state,n.dontIndentStates)>-1)return e.Pass;var i=r.indent.length-1,s=t[r.state];e:for(;;){for(var f=0;f<s.length;f++){var u=s[f];if(u.data.dedent&&u.data.dedentIfLineStart!==!1){var c=u.regex.exec(a);if(c&&c[0]){i--,(u.next||u.push)&&(s=t[u.next||u.push]),a=a.slice(c[0].length);continue e}}}break}return 0>i?0:r.indent[i]}}e.defineSimpleMode=function(t,n){e.defineMode(t,function(t){return e.simpleMode(t,n)})},e.simpleMode=function(n,r){t(r,"start");var i={},s=r.meta||{},l=!1;for(var u in r)if(u!=s&&r.hasOwnProperty(u))for(var c=i[u]=[],d=r[u],m=0;m<d.length;m++){var p=d[m];c.push(new a(p,r)),(p.indent||p.dedent)&&(l=!0)}var y={startState:function(){return{state:"start",pending:null,local:null,localState:null,indent:l?[]:null}},copyState:function(t){var n={state:t.state,pending:t.pending,local:t.local,localState:null,indent:t.indent&&t.indent.slice(0)};t.localState&&(n.localState=e.copyState(t.local.mode,t.localState)),t.stack&&(n.stack=t.stack.slice(0));for(var r=t.persistentStates;r;r=r.next)n.persistentStates={mode:r.mode,spec:r.spec,state:r.state==t.localState?n.localState:e.copyState(r.mode,r.state),next:n.persistentStates};return n},token:o(i,n),innerMode:function(e){return e.local&&{mode:e.local.mode,state:e.localState}},indent:f(i,s)};if(s)for(var v in s)s.hasOwnProperty(v)&&(y[v]=s[v]);return y}});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../dialog/dialog"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t,r,i,n){e.openDialog?e.openDialog(t,n,{value:i,selectValueOnOpen:!0}):n(prompt(r,i))}function i(e,t){var r=Number(t);return/^[-+]/.test(t)?e.getCursor().line+r:r-1}var r='Jump to line: <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use line:column or scroll% syntax)</span>';e.commands.jumpToLine=function(e){var n=e.getCursor();t(e,r,"Jump to line:",n.line+1+":"+n.ch,function(t){if(t){var r;if(r=/^\s*([\+\-]?\d+)\s*\:\s*(\d+)\s*$/.exec(t))e.setCursor(i(e,r[1]),Number(r[2]));else if(r=/^\s*([\+\-]?\d+(\.\d+)?)\%\s*/.exec(t)){var a=Math.round(e.lineCount()*Number(r[1])/100);/^[-+]/.test(r[1])&&(a=n.line+a+1),e.setCursor(a-1,n.ch)}else(r=/^\s*\:?\s*([\+\-]?\d+)\s*/.exec(t))&&e.setCursor(i(e,r[1]),n.ch)}})},e.keyMap["default"]["Alt-G"]="jumpToLine"});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],e):e(CodeMirror)}(function(e){"use strict";function t(e,t){return"string"==typeof e?e=new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t?"gi":"g"):e.global||(e=new RegExp(e.source,e.ignoreCase?"gi":"g")),{token:function(t){e.lastIndex=t.pos;var r=e.exec(t.string);return r&&r.index==t.pos?(t.pos+=r[0].length||1,"searching"):void(r?t.pos=r.index:t.skipToEnd())}}}function r(){this.posFrom=this.posTo=this.lastQuery=this.query=null,this.overlay=null}function i(e){return e.state.search||(e.state.search=new r)}function n(e){return"string"==typeof e&&e==e.toLowerCase()}function o(e,t,r){return e.getSearchCursor(t,r,{caseFold:n(t),multiline:!0})}function a(e,t,r,i,n){e.openDialog(t,i,{value:r,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){h(e)},onKeyDown:n})}function l(e,t,r,i,n){e.openDialog?e.openDialog(t,n,{value:i,selectValueOnOpen:!0}):n(prompt(r,i))}function s(e,t,r,i){e.openConfirm?e.openConfirm(t,i):confirm(r)&&i[0]()}function c(e){return e.replace(/\\(.)/g,function(e,t){return"n"==t?"\n":"r"==t?"\r":t})}function u(e){var t=e.match(/^\/(.*)\/([a-z]*)$/);if(t)try{e=new RegExp(t[1],-1==t[2].indexOf("i")?"":"i")}catch(r){}else e=c(e);return("string"==typeof e?""==e:e.test(""))&&(e=/x^/),e}function d(e,r,i){r.queryText=i,r.query=u(i),e.removeOverlay(r.overlay,n(r.query)),r.overlay=t(r.query,n(r.query)),e.addOverlay(r.overlay),e.showMatchesOnScrollbar&&(r.annotate&&(r.annotate.clear(),r.annotate=null),r.annotate=e.showMatchesOnScrollbar(r.query,n(r.query)))}function p(t,r,n,o){var s=i(t);if(s.query)return m(t,r);var c=t.getSelection()||s.lastQuery;if(n&&t.openDialog){var u=null,p=function(r,i){e.e_stop(i),r&&(r!=s.queryText&&(d(t,s,r),s.posFrom=s.posTo=t.getCursor()),u&&(u.style.opacity=1),m(t,i.shiftKey,function(e,r){var i;r.line<3&&document.querySelector&&(i=t.display.wrapper.querySelector(".CodeMirror-dialog"))&&i.getBoundingClientRect().bottom-4>t.cursorCoords(r,"window").top&&((u=i).style.opacity=.4)}))};a(t,f,c,p,function(r,n){var o=e.keyName(r),a=e.keyMap[t.getOption("keyMap")][o];a||(a=t.getOption("extraKeys")[o]),"findNext"==a||"findPrev"==a||"findPersistentNext"==a||"findPersistentPrev"==a?(e.e_stop(r),d(t,i(t),n),t.execCommand(a)):("find"==a||"findPersistent"==a)&&(e.e_stop(r),p(n,r))}),o&&c&&(d(t,s,c),m(t,r))}else l(t,f,"Search for:",c,function(e){e&&!s.query&&t.operation(function(){d(t,s,e),s.posFrom=s.posTo=t.getCursor(),m(t,r)})})}function m(t,r,n){t.operation(function(){var a=i(t),l=o(t,a.query,r?a.posFrom:a.posTo);(l.find(r)||(l=o(t,a.query,r?e.Pos(t.lastLine()):e.Pos(t.firstLine(),0)),l.find(r)))&&(t.setSelection(l.from(),l.to()),t.scrollIntoView({from:l.from(),to:l.to()},20),a.posFrom=l.from(),a.posTo=l.to(),n&&n(l.from(),l.to()))})}function h(e){e.operation(function(){var t=i(e);t.lastQuery=t.query,t.query&&(t.query=t.queryText=null,e.removeOverlay(t.overlay),t.annotate&&(t.annotate.clear(),t.annotate=null))})}function b(e,t,r){e.operation(function(){for(var i=o(e,t);i.findNext();)if("string"!=typeof t){var n=e.getRange(i.from(),i.to()).match(t);i.replace(r.replace(/\$(\d)/g,function(e,t){return n[t]}))}else i.replace(r)})}function x(e,t){if(!e.getOption("readOnly")){var r=e.getSelection()||i(e).lastQuery,n='<span class="CodeMirror-search-label">'+(t?"Replace all:":"Replace:")+"</span>";l(e,n+g,n,r,function(r){r&&(r=u(r),l(e,v,"Replace with:","",function(i){if(i=c(i),t)b(e,r,i);else{h(e);var n=o(e,r,e.getCursor("from")),a=function(){var c,t=n.from();!(c=n.findNext())&&(n=o(e,r),!(c=n.findNext())||t&&n.from().line==t.line&&n.from().ch==t.ch)||(e.setSelection(n.from(),n.to()),e.scrollIntoView({from:n.from(),to:n.to()}),s(e,y,"Replace?",[function(){l(c)},a,function(){b(e,r,i)}]))},l=function(e){n.replace("string"==typeof r?i:i.replace(/\$(\d)/g,function(t,r){return e[r]})),a()};a()}}))})}}var f='<span class="CodeMirror-search-label">Search:</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',g=' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>',v='<span class="CodeMirror-search-label">With:</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/>',y='<span class="CodeMirror-search-label">Replace?</span> <button>Yes</button> <button>No</button> <button>All</button> <button>Stop</button>';e.commands.find=function(e){h(e),p(e)},e.commands.findPersistent=function(e){h(e),p(e,!1,!0)},e.commands.findPersistentNext=function(e){p(e,!1,!0,!0)},e.commands.findPersistentPrev=function(e){p(e,!0,!0,!0)},e.commands.findNext=p,e.commands.findPrev=function(e){p(e,!0)},e.commands.clearSearch=h,e.commands.replace=x,e.commands.replaceAll=function(e){x(e,!0)}});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function r(e){var t=e.flags;return null!=t?t:(e.ignoreCase?"i":"")+(e.global?"g":"")+(e.multiline?"m":"")}function i(e){return e.global?e:new RegExp(e.source,r(e)+"g")}function n(e){return/\\s|\\n|\n|\\W|\\D|\[\^/.test(e.source)}function o(e,r,n){r=i(r);for(var o=n.line,a=n.ch,l=e.lastLine();l>=o;o++,a=0){r.lastIndex=a;var s=e.getLine(o),c=r.exec(s);if(c)return{from:t(o,c.index),to:t(o,c.index+c[0].length),match:c}}}function a(e,r,a){if(!n(r))return o(e,r,a);r=i(r);for(var l,s=1,c=a.line,u=e.lastLine();u>=c;){for(var f=0;s>f;f++){var d=e.getLine(c++);l=null==l?d:l+"\n"+d}s=2*s,r.lastIndex=a.ch;var p=r.exec(l);if(p){var h=l.slice(0,p.index).split("\n"),m=p[0].split("\n"),g=a.line+h.length-1,v=h[h.length-1].length;return{from:t(g,v),to:t(g+m.length-1,1==m.length?v+m[0].length:m[m.length-1].length),match:p}}}}function l(e,t){for(var i,r=0;;){t.lastIndex=r;var n=t.exec(e);if(!n)return i;if(i=n,r=i.index+(i[0].length||1),r==e.length)return i}}function s(e,r,n){r=i(r);for(var o=n.line,a=n.ch,s=e.firstLine();o>=s;o--,a=-1){var c=e.getLine(o);a>-1&&(c=c.slice(0,a));var u=l(c,r);if(u)return{from:t(o,u.index),to:t(o,u.index+u[0].length),match:u}}}function c(e,r,n){r=i(r);for(var o,a=1,s=n.line,c=e.firstLine();s>=c;){for(var u=0;a>u;u++){var f=e.getLine(s--);o=null==o?f.slice(0,n.ch):f+"\n"+o}a*=2;var d=l(o,r);if(d){var p=o.slice(0,d.index).split("\n"),h=d[0].split("\n"),m=s+p.length,g=p[p.length-1].length;return{from:t(m,g),to:t(m+h.length-1,1==h.length?g+h[0].length:h[h.length-1].length),match:d}}}}function d(e,t,r,i){if(e.length==t.length)return r;for(var n=Math.min(r,e.length);;){var o=i(e.slice(0,n)).length;if(r>o)++n;else{if(!(o>r))return n;--n}}}function p(e,r,i,n){if(!r.length)return null;var o=n?u:f,a=o(r).split(/\r|\n\r?/);e:for(var l=i.line,s=i.ch,c=e.lastLine()+1-a.length;c>=l;l++,s=0){var p=e.getLine(l).slice(s),h=o(p);if(1==a.length){var m=h.indexOf(a[0]);if(-1==m)continue e;var i=d(p,h,m,o)+s;return{from:t(l,d(p,h,m,o)+s),to:t(l,d(p,h,m+a[0].length,o)+s)}}var g=h.length-a[0].length;if(h.slice(g)==a[0]){for(var v=1;v<a.length-1;v++)if(o(e.getLine(l+v))!=a[v])continue e;var y=e.getLine(l+a.length-1),b=o(y),x=a[a.length-1];if(y.slice(0,x.length)==x)return{from:t(l,d(p,h,g,o)+s),to:t(l+a.length-1,d(y,b,x.length,o))}}}}function h(e,r,i,n){if(!r.length)return null;var o=n?u:f,a=o(r).split(/\r|\n\r?/);e:for(var l=i.line,s=i.ch,c=e.firstLine()-1+a.length;l>=c;l--,s=-1){var p=e.getLine(l);s>-1&&(p=p.slice(0,s));var h=o(p);if(1==a.length){var m=h.lastIndexOf(a[0]);if(-1==m)continue e;return{from:t(l,d(p,h,m,o)),to:t(l,d(p,h,m+a[0].length,o))}}var g=a[a.length-1];if(h.slice(0,g.length)==g){for(var v=1,i=l-a.length+1;v<a.length-1;v++)if(o(e.getLine(i+v))!=a[v])continue e;var y=e.getLine(l+1-a.length),b=o(y);if(b.slice(b.length-a[0].length)==a[0])return{from:t(l+1-a.length,d(y,b,y.length-a[0].length,o)),to:t(l,d(p,h,g.length,o))}}}}function m(e,r,n,l){this.atOccurrence=!1,this.doc=e,n=n?e.clipPos(n):t(0,0),this.pos={from:n,to:n};var u;"object"==typeof l?u=l.caseFold:(u=l,l=null),"string"==typeof r?(null==u&&(u=!1),this.matches=function(t,i){return(t?h:p)(e,r,i,u)}):(r=i(r),l&&l.multiline===!1?this.matches=function(t,i){return(t?s:o)(e,r,i)}:this.matches=function(t,i){return(t?c:a)(e,r,i)})}var u,f,t=e.Pos;String.prototype.normalize?(u=function(e){return e.normalize("NFD").toLowerCase()},f=function(e){return e.normalize("NFD")}):(u=function(e){return e.toLowerCase()},f=function(e){return e}),m.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(r){for(var i=this.matches(r,this.doc.clipPos(r?this.pos.from:this.pos.to));i&&0==e.cmpPos(i.from,i.to);)r?i.from.ch?i.from=t(i.from.line,i.from.ch-1):i=i.from.line==this.doc.firstLine()?null:this.matches(r,this.doc.clipPos(t(i.from.line-1))):i.to.ch<this.doc.getLine(i.to.line).length?i.to=t(i.to.line,i.to.ch+1):i=i.to.line==this.doc.lastLine()?null:this.matches(r,t(i.to.line+1,0));if(i)return this.pos=i,this.atOccurrence=!0,this.pos.match||!0;var n=t(r?this.doc.firstLine():this.doc.lastLine()+1,0);return this.pos={from:n,to:n},this.atOccurrence=!1},from:function(){return this.atOccurrence?this.pos.from:void 0},to:function(){return this.atOccurrence?this.pos.to:void 0},replace:function(r,i){if(this.atOccurrence){var n=e.splitLines(r);this.doc.replaceRange(n,this.pos.from,this.pos.to,i),this.pos.to=t(this.pos.from.line+n.length-1,n[n.length-1].length+(1==n.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",function(e,t,r){return new m(this.doc,e,t,r)}),e.defineDocExtension("getSearchCursor",function(e,t,r){return new m(this,e,t,r)}),e.defineExtension("selectMatches",function(t,r){for(var i=[],n=this.getSearchCursor(t,this.getCursor("from"),r);n.findNext()&&!(e.cmpPos(n.to(),this.getCursor("to"))>0);)i.push({anchor:n.from(),head:n.to()});i.length&&this.setSelections(i,0)})});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";var n=/[\w$]+/,t=500;e.registerHelper("hint","anyword",function(r,i){for(var a=i&&i.word||n,o=i&&i.range||t,u=r.getCursor(),c=r.getLine(u.line),f=u.ch,s=f;s&&a.test(c.charAt(s-1));)--s;for(var l=s!=f&&c.slice(s,f),d=i&&i.list||[],m={},p=new RegExp(a.source,"g"),h=-1;1>=h;h+=2)for(var v=u.line,y=Math.min(Math.max(v+h*o,r.firstLine()),r.lastLine())+h;v!=y;v+=h)for(var w,g=r.getLine(v);w=p.exec(g);)(v!=u.line||w[0]!==l)&&(l&&0!=w[0].lastIndexOf(l,0)||Object.prototype.hasOwnProperty.call(m,w[0])||(m[w[0]]=!0,d.push(w[0])));return{list:d,from:e.Pos(u.line,s),to:e.Pos(u.line,f)}})});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function r(e,t){this.cm=e,this.options=t,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length;var n=this;e.on("cursorActivity",this.activityFunc=function(){n.cursorActivity()})}function o(t,n){var r=e.cmpPos(n.from,t.from);return r>0&&t.to.ch-t.from.ch!=n.to.ch-n.from.ch}function u(e,t,n){var r=e.options.hintOptions,i={};for(var a in p)i[a]=p[a];if(r)for(var a in r)void 0!==r[a]&&(i[a]=r[a]);if(n)for(var a in n)void 0!==n[a]&&(i[a]=n[a]);return i.hint.resolve&&(i.hint=i.hint.resolve(e,t)),i}function c(e){return"string"==typeof e?e:e.text}function s(e,t){function a(e,r){var a;a="string"!=typeof r?function(e){return r(e,t)}:n.hasOwnProperty(r)?n[r]:r,i[e]=a}var n={Up:function(){t.moveFocus(-1)},Down:function(){t.moveFocus(1)},PageUp:function(){t.moveFocus(-t.menuSize()+1,!0)},PageDown:function(){t.moveFocus(t.menuSize()-1,!0)},Home:function(){t.setFocus(0)},End:function(){t.setFocus(t.length-1)},Enter:t.pick,Tab:t.pick,Esc:t.close},r=e.options.customKeys,i=r?{}:n;if(r)for(var o in r)r.hasOwnProperty(o)&&a(o,r[o]);var u=e.options.extraKeys;if(u)for(var o in u)u.hasOwnProperty(o)&&a(o,u[o]);return i}function f(e,t){for(;t&&t!=e;){if("LI"===t.nodeName.toUpperCase()&&t.parentNode==e)return t;t=t.parentNode}}function l(r,i){this.completion=r,this.data=i,this.picked=!1;var a=this,o=r.cm,u=this.hints=document.createElement("ul");u.className="CodeMirror-hints",this.selectedHint=i.selectedHint||0;for(var l=i.list,d=0;d<l.length;++d){var m=u.appendChild(document.createElement("li")),h=l[d],p=t+(d!=this.selectedHint?"":" "+n);null!=h.className&&(p=h.className+" "+p),m.className=p,h.render?h.render(m,i,h):m.appendChild(document.createTextNode(h.displayText||c(h))),m.hintId=d}var v=o.cursorCoords(r.options.alignWithWord?i.from:null),y=v.left,g=v.bottom,w=!0;u.style.left=y+"px",u.style.top=g+"px";var N=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),T=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(r.options.container||document.body).appendChild(u);var D=u.getBoundingClientRect(),b=D.bottom-T,M=u.scrollHeight>u.clientHeight+1,k=o.getScrollInfo();if(b>0){var x=D.bottom-D.top,E=v.top-(v.bottom-D.top);if(E-x>0)u.style.top=(g=v.top-x)+"px",w=!1;else if(x>T){u.style.height=T-5+"px",u.style.top=(g=v.bottom-D.top)+"px";var I=o.getCursor();i.from.ch!=I.ch&&(v=o.cursorCoords(I),u.style.left=(y=v.left)+"px",D=u.getBoundingClientRect())}}var C=D.right-N;if(C>0&&(D.right-D.left>N&&(u.style.width=N-5+"px",C-=D.right-D.left-N),u.style.left=(y=v.left-C)+"px"),M)for(var F=u.firstChild;F;F=F.nextSibling)F.style.paddingRight=o.display.nativeBarWidth+"px";if(o.addKeyMap(this.keyMap=s(r,{moveFocus:function(e,t){a.changeActive(a.selectedHint+e,t)},setFocus:function(e){a.changeActive(e)},menuSize:function(){return a.screenAmount()},length:l.length,close:function(){r.close()},pick:function(){a.pick()},data:i})),r.options.closeOnUnfocus){var B;o.on("blur",this.onBlur=function(){B=setTimeout(function(){r.close()},100)}),o.on("focus",this.onFocus=function(){clearTimeout(B)})}return o.on("scroll",this.onScroll=function(){var e=o.getScrollInfo(),t=o.getWrapperElement().getBoundingClientRect(),n=g+k.top-e.top,i=n-(window.pageYOffset||(document.documentElement||document.body).scrollTop);return w||(i+=u.offsetHeight),i<=t.top||i>=t.bottom?r.close():(u.style.top=n+"px",void(u.style.left=y+k.left-e.left+"px"))}),e.on(u,"dblclick",function(e){var t=f(u,e.target||e.srcElement);t&&null!=t.hintId&&(a.changeActive(t.hintId),a.pick())}),e.on(u,"click",function(e){var t=f(u,e.target||e.srcElement);t&&null!=t.hintId&&(a.changeActive(t.hintId),r.options.completeOnSingleClick&&a.pick())}),e.on(u,"mousedown",function(){setTimeout(function(){o.focus()},20)}),e.signal(i,"select",l[0],u.firstChild),!0}function d(e,t){if(!e.somethingSelected())return t;for(var n=[],r=0;r<t.length;r++)t[r].supportsSelection&&n.push(t[r]);return n}function m(e,t,n,r){if(e.async)e(t,r,n);else{var i=e(t,n);i&&i.then?i.then(r):r(i)}}function h(t,n){var i,r=t.getHelpers(n,"hint");if(r.length){var a=function(e,t,n){function a(r){return r==i.length?t(null):void m(i[r],e,n,function(e){e&&e.list.length>0?t(e):a(r+1)})}var i=d(e,r);a(0)};return a.async=!0,a.supportsSelection=!0,a}return(i=t.getHelper(t.getCursor(),"hintWords"))?function(t){return e.hint.fromList(t,{words:i})}:e.hint.anyword?function(t,n){return e.hint.anyword(t,n)}:function(){}}var t="CodeMirror-hint",n="CodeMirror-hint-active";e.showHint=function(e,t,n){if(!t)return e.showHint(n);n&&n.async&&(t.async=!0);var r={hint:t};if(n)for(var i in n)r[i]=n[i];return e.showHint(r)},e.defineExtension("showHint",function(t){t=u(this,this.getCursor("start"),t);var n=this.listSelections();if(!(n.length>1)){if(this.somethingSelected()){if(!t.hint.supportsSelection)return;for(var i=0;i<n.length;i++)if(n[i].head.line!=n[i].anchor.line)return}this.state.completionActive&&this.state.completionActive.close();var a=this.state.completionActive=new r(this,t);a.options.hint&&(e.signal(this,"startCompletion",this),a.update(!0))}});var i=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},a=window.cancelAnimationFrame||clearTimeout;r.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&e.signal(this.data,"close"),this.widget&&this.widget.close(),e.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,n){var r=t.list[n];r.hint?r.hint(this.cm,t,r):this.cm.replaceRange(c(r),r.from||t.from,r.to||t.to,"complete"),e.signal(t,"pick",r),this.close()},cursorActivity:function(){this.debounce&&(a(this.debounce),this.debounce=0);var e=this.cm.getCursor(),t=this.cm.getLine(e.line);if(e.line!=this.startPos.line||t.length-e.ch!=this.startLen-this.startPos.ch||e.ch<this.startPos.ch||this.cm.somethingSelected()||e.ch&&this.options.closeCharacters.test(t.charAt(e.ch-1)))this.close();else{var n=this;this.debounce=i(function(){n.update()}),this.widget&&this.widget.disable()}},update:function(e){if(null!=this.tick){var t=this,n=++this.tick;m(this.options.hint,this.cm,this.options,function(r){t.tick==n&&t.finishUpdate(r,e)})}},finishUpdate:function(t,n){this.data&&e.signal(this.data,"update");var r=this.widget&&this.widget.picked||n&&this.options.completeSingle;this.widget&&this.widget.close(),t&&this.data&&o(this.data,t)||(this.data=t,t&&t.list.length&&(r&&1==t.list.length?this.pick(t,0):(this.widget=new l(this,t),e.signal(t,"shown"))))}},l.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var e=this.completion.cm;this.completion.options.closeOnUnfocus&&(e.off("blur",this.onBlur),e.off("focus",this.onFocus)),e.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var e=this;this.keyMap={Enter:function(){e.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(t,r){if(t>=this.data.list.length?t=r?this.data.list.length-1:0:0>t&&(t=r?0:this.data.list.length-1),this.selectedHint!=t){var i=this.hints.childNodes[this.selectedHint];i.className=i.className.replace(" "+n,""),i=this.hints.childNodes[this.selectedHint=t],i.className+=" "+n,i.offsetTop<this.hints.scrollTop?this.hints.scrollTop=i.offsetTop-3:i.offsetTop+i.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=i.offsetTop+i.offsetHeight-this.hints.clientHeight+3),e.signal(this.data,"select",this.data.list[this.selectedHint],i)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},e.registerHelper("hint","auto",{resolve:h}),e.registerHelper("hint","fromList",function(t,n){var r=t.getCursor(),i=t.getTokenAt(r),a=e.Pos(r.line,i.end);if(i.string&&/\w/.test(i.string[i.string.length-1]))var o=i.string,u=e.Pos(r.line,i.start);else var o="",u=a;for(var c=[],s=0;s<n.words.length;s++){var f=n.words[s];f.slice(0,o.length)==o&&c.push(f)}return c.length?{list:c,from:u,to:a}:void 0}),e.commands.autocomplete=e.showHint;var p={hint:e.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null};e.defineOption("hintOptions",null)});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function r(e){for(var r=0;r<e.state.activeLines.length;r++)e.removeLineClass(e.state.activeLines[r],"wrap",t),e.removeLineClass(e.state.activeLines[r],"background",i),e.removeLineClass(e.state.activeLines[r],"gutter",n)}function a(e,t){if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0}function o(e,o){for(var s=[],f=0;f<o.length;f++){var l=o[f],c=e.getOption("styleActiveLine");if("object"==typeof c&&c.nonEmpty?l.anchor.line==l.head.line:l.empty()){var v=e.getLineHandleVisualStart(l.head.line);s[s.length-1]!=v&&s.push(v)}}a(e.state.activeLines,s)||e.operation(function(){r(e);for(var a=0;a<s.length;a++)e.addLineClass(s[a],"wrap",t),e.addLineClass(s[a],"background",i),e.addLineClass(s[a],"gutter",n);e.state.activeLines=s})}function s(e,t){o(e,t.ranges)}var t="CodeMirror-activeline",i="CodeMirror-activeline-background",n="CodeMirror-activeline-gutter";e.defineOption("styleActiveLine",!1,function(t,i,n){var a=n==e.Init?!1:n;i!=a&&(a&&(t.off("beforeSelectionChange",s),r(t),delete t.state.activeLines),i&&(t.state.activeLines=[],o(t,t.listSelections()),t.on("beforeSelectionChange",s)))})});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function i(e,r){return"pairs"==r&&"string"==typeof e?e:"object"==typeof e&&null!=e[r]?e[r]:t[r]}function l(e){return function(t){return d(t,e)}}function s(e){var t=e.state.closeBrackets;if(!t||t.override)return t;var r=e.getModeAt(e.getCursor());return r.closeBrackets||t}function u(t){var n=s(t);if(!n||t.getOption("disableInput"))return e.Pass;for(var a=i(n,"pairs"),o=t.listSelections(),l=0;l<o.length;l++){if(!o[l].empty())return e.Pass;var u=m(t,o[l].head);if(!u||a.indexOf(u)%2!=0)return e.Pass}for(var l=o.length-1;l>=0;l--){var c=o[l].head;t.replaceRange("",r(c.line,c.ch-1),r(c.line,c.ch+1),"+delete")}}function c(t){var r=s(t),n=r&&i(r,"explode");if(!n||t.getOption("disableInput"))return e.Pass;for(var a=t.listSelections(),o=0;o<a.length;o++){if(!a[o].empty())return e.Pass;var l=m(t,a[o].head);if(!l||n.indexOf(l)%2!=0)return e.Pass}t.operation(function(){t.replaceSelection("\n\n",null),t.execCommand("goCharLeft"),a=t.listSelections();for(var e=0;e<a.length;e++){var r=a[e].head.line;t.indentLine(r,null,!0),t.indentLine(r+1,null,!0)}})}function f(t){var i=e.cmpPos(t.anchor,t.head)>0;return{anchor:new r(t.anchor.line,t.anchor.ch+(i?-1:1)),head:new r(t.head.line,t.head.ch+(i?1:-1))}}function d(t,n){var a=s(t);if(!a||t.getOption("disableInput"))return e.Pass;var o=i(a,"pairs"),l=o.indexOf(n);if(-1==l)return e.Pass;for(var v,u=i(a,"triples"),c=o.charAt(l+1)==n,d=t.listSelections(),m=l%2==0,y=0;y<d.length;y++){var _,b=d[y],x=b.head,w=t.getRange(x,r(x.line,x.ch+1));if(m&&!b.empty())_="surround";else if(!c&&m||w!=n)if(c&&x.ch>1&&u.indexOf(n)>=0&&t.getRange(r(x.line,x.ch-2),x)==n+n&&(x.ch<=2||t.getRange(r(x.line,x.ch-3),r(x.line,x.ch-2))!=n))_="addFour";else if(c){if(e.isWordChar(w)||!h(t,x,n))return e.Pass;_="both"}else{if(!m||t.getLine(x.line).length!=x.ch&&!p(w,o)&&!/\s/.test(w))return e.Pass;_="both"}else _=c&&g(t,x)?"both":u.indexOf(n)>=0&&t.getRange(x,r(x.line,x.ch+3))==n+n+n?"skipThree":"skip";if(v){if(v!=_)return e.Pass}else v=_}var k=l%2?o.charAt(l-1):n,C=l%2?n:o.charAt(l+1);t.operation(function(){if("skip"==v)t.execCommand("goCharRight");else if("skipThree"==v)for(var e=0;3>e;e++)t.execCommand("goCharRight");else if("surround"==v){for(var r=t.getSelections(),e=0;e<r.length;e++)r[e]=k+r[e]+C;t.replaceSelections(r,"around"),r=t.listSelections().slice();for(var e=0;e<r.length;e++)r[e]=f(r[e]);t.setSelections(r)}else"both"==v?(t.replaceSelection(k+C,null),t.triggerElectric(k+C),t.execCommand("goCharLeft")):"addFour"==v&&(t.replaceSelection(k+k+k+k,"before"),t.execCommand("goCharRight"))})}function p(e,t){var r=t.lastIndexOf(e);return r>-1&&r%2==1}function m(e,t){var i=e.getRange(r(t.line,t.ch-1),r(t.line,t.ch+1));return 2==i.length?i:null}function h(t,r,i){var n=t.getLine(r.line),a=t.getTokenAt(r);if(/\bstring2?\b/.test(a.type)||g(t,r))return!1;var o=new e.StringStream(n.slice(0,r.ch)+i+n.slice(r.ch),4);for(o.pos=o.start=a.start;;){var l=t.getMode().token(o,a.state);if(o.pos>=r.ch+1)return/\bstring2?\b/.test(l);o.start=o.pos}}function g(e,t){var i=e.getTokenAt(r(t.line,t.ch+1));return/\bstring/.test(i.type)&&i.start==t.ch}var t={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},r=e.Pos;e.defineOption("autoCloseBrackets",!1,function(t,r,i){i&&i!=e.Init&&(t.removeKeyMap(a),t.state.closeBrackets=null),r&&(t.state.closeBrackets=r,t.addKeyMap(a))});for(var n=t.pairs+"`",a={Backspace:u,Enter:c},o=0;o<n.length;o++)a["'"+n.charAt(o)+"'"]=l(n.charAt(o))});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){function i(i){if(i.getOption("disableInput"))return e.Pass;for(var n=i.listSelections(),a=[],s=0;s<n.length;s++){if(!n[s].empty())return e.Pass;var u=n[s].head,c=i.getTokenAt(u),f=e.innerMode(i.getMode(),c.state),d=f.state;if("xml"!=f.mode.name||!d.tagName)return e.Pass;var p=i.getOption("autoCloseTags"),m="html"==f.mode.configuration,h="object"==typeof p&&p.dontCloseTags||m&&t,g="object"==typeof p&&p.indentTags||m&&r,v=d.tagName;c.end>u.ch&&(v=v.slice(0,v.length-c.end+u.ch));var y=v.toLowerCase();if(!v||"string"==c.type&&(c.end!=u.ch||!/[\"\']/.test(c.string.charAt(c.string.length-1))||1==c.string.length)||"tag"==c.type&&"closeTag"==d.type||c.string.indexOf("/")==c.string.length-1||h&&o(h,y)>-1||l(i,v,u,d,!0))return e.Pass;var b=g&&o(g,y)>-1;a[s]={indent:b,text:">"+(b?"\n\n":"")+"</"+v+">",newPos:b?e.Pos(u.line+1,0):e.Pos(u.line,u.ch+1)}}for(var s=n.length-1;s>=0;s--){var x=a[s];i.replaceRange(x.text,n[s].head,n[s].anchor,"+insert");var _=i.listSelections().slice(0);_[s]={head:x.newPos,anchor:x.newPos},i.setSelections(_),x.indent&&(i.indentLine(x.newPos.line,null,!0),i.indentLine(x.newPos.line+1,null,!0))}}function n(t,r){for(var i=t.listSelections(),n=[],a=r?"/":"</",o=0;o<i.length;o++){if(!i[o].empty())return e.Pass;var s=i[o].head,u=t.getTokenAt(s),c=e.innerMode(t.getMode(),u.state),f=c.state;if(r&&("string"==u.type||"<"!=u.string.charAt(0)||u.start!=s.ch-1))return e.Pass;var d;if("xml"!=c.mode.name)if("htmlmixed"==t.getMode().name&&"javascript"==c.mode.name)d=a+"script";else{if("htmlmixed"!=t.getMode().name||"css"!=c.mode.name)return e.Pass;d=a+"style"}else{if(!f.context||!f.context.tagName||l(t,f.context.tagName,s,f))return e.Pass;d=a+f.context.tagName}">"!=t.getLine(s.line).charAt(u.end)&&(d+=">"),n[o]=d}t.replaceSelections(n),i=t.listSelections();for(var o=0;o<i.length;o++)(o==i.length-1||i[o].head.line<i[o+1].head.line)&&t.indentLine(i[o].head.line)}function a(t){return t.getOption("disableInput")?e.Pass:n(t,!0)}function o(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,i=e.length;i>r;++r)if(e[r]==t)return r;return-1}function l(t,r,i,n,a){if(!e.scanForClosingTag)return!1;var o=Math.min(t.lastLine()+1,i.line+500),l=e.scanForClosingTag(t,i,null,o);if(!l||l.tag!=r)return!1;for(var s=n.context,u=a?1:0;s&&s.tagName==r;s=s.prev)++u;i=l.to;for(var c=1;u>c;c++){var f=e.scanForClosingTag(t,i,null,o);if(!f||f.tag!=r)return!1;i=f.to}return!0}e.defineOption("autoCloseTags",!1,function(t,r,n){if(n!=e.Init&&n&&t.removeKeyMap("autoCloseTags"),r){var o={name:"autoCloseTags"};("object"!=typeof r||r.whenClosing)&&(o["'/'"]=function(e){return a(e)}),("object"!=typeof r||r.whenOpening)&&(o["'>'"]=function(e){return i(e)}),t.addKeyMap(o)}});var t=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],r=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];e.commands.closeTag=function(e){return n(e)}});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";var t=/^(\s*)(>[> ]*|[*+-] \[[x ]\]\s|[*+-]\s|(\d+)([.)]))(\s*)/,r=/^(\s*)(>[> ]*|[*+-] \[[x ]\]|[*+-]|(\d+)[.)])(\s*)$/,i=/[*+-]\s/;e.commands.newlineAndIndentContinueMarkdownList=function(n){if(n.getOption("disableInput"))return e.Pass;for(var a=n.listSelections(),o=[],l=0;l<a.length;l++){var s=a[l].head,u=n.getStateAfter(s.line),c=u.list!==!1,f=0!==u.quote,d=n.getLine(s.line),p=t.exec(d);if(!a[l].empty()||!c&&!f||!p)return void n.execCommand("newlineAndIndent");if(r.test(d))/>\s*$/.test(d)||n.replaceRange("",{line:s.line,ch:0},{line:s.line,ch:s.ch+1}),o[l]="\n";else{var m=p[1],h=p[5],g=i.test(p[2])||p[2].indexOf(">")>=0?p[2].replace("x"," "):parseInt(p[3],10)+1+p[4];o[l]="\n"+m+g+h}}n.replaceSelections(o)}});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function n(e,t,n){var o=e.getLineHandle(t.line),l=t.ch-1,s=n&&n.afterCursor;null==s&&(s=/(^| )cm-fat-cursor($| )/.test(e.getWrapperElement().className));var u=!s&&l>=0&&i[o.text.charAt(l)]||i[o.text.charAt(++l)];if(!u)return null;var c=">"==u.charAt(1)?1:-1;if(n&&n.strict&&c>0!=(l==t.ch))return null;var f=e.getTokenTypeAt(r(t.line,l+1)),d=a(e,r(t.line,l+(c>0?1:0)),c,f||null,n);return null==d?null:{from:r(t.line,l),to:d&&d.pos,match:d&&d.ch==u.charAt(0),forward:c>0}}function a(e,t,n,a,o){for(var l=o&&o.maxScanLineLength||1e4,s=o&&o.maxScanLines||1e3,u=[],c=o&&o.bracketRegex?o.bracketRegex:/[(){}[\]]/,f=n>0?Math.min(t.line+s,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-s),d=t.line;d!=f;d+=n){var p=e.getLine(d);if(p){var m=n>0?0:p.length-1,h=n>0?p.length:-1;if(!(p.length>l))for(d==t.line&&(m=t.ch-(0>n?1:0));m!=h;m+=n){var g=p.charAt(m);if(c.test(g)&&(void 0===a||e.getTokenTypeAt(r(d,m+1))==a)){var v=i[g];if(">"==v.charAt(1)==n>0)u.push(g);else{if(!u.length)return{pos:r(d,m),ch:g};u.pop()}}}}}return d-n==(n>0?e.lastLine():e.firstLine())?!1:null}function o(e,i,a){for(var o=e.state.matchBrackets.maxHighlightLineLength||1e3,l=[],s=e.listSelections(),u=0;u<s.length;u++){var c=s[u].empty()&&n(e,s[u].head,a);if(c&&e.getLine(c.from.line).length<=o){var f=c.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";l.push(e.markText(c.from,r(c.from.line,c.from.ch+1),{className:f})),c.to&&e.getLine(c.to.line).length<=o&&l.push(e.markText(c.to,r(c.to.line,c.to.ch+1),{className:f}))}}if(l.length){t&&e.state.focused&&e.focus();var d=function(){e.operation(function(){for(var e=0;e<l.length;e++)l[e].clear()})};if(!i)return d;setTimeout(d,800)}}function s(e){e.operation(function(){l&&(l(),l=null),l=o(e,!1,e.state.matchBrackets)})}var t=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),r=e.Pos,i={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},l=null;e.defineOption("matchBrackets",!1,function(t,r,i){i&&i!=e.Init&&(t.off("cursorActivity",s),l&&(l(),l=null)),r&&(t.state.matchBrackets="object"==typeof r?r:{},t.on("cursorActivity",s))}),e.defineExtension("matchBrackets",function(){o(this,!0)}),e.defineExtension("findMatchingBracket",function(e,t,r){return(r||"boolean"==typeof t)&&(r?(r.strict=t,t=r):t=t?{strict:!0}:null),n(this,e,t)}),e.defineExtension("scanForBracket",function(e,t,r,i){return a(this,e,t,r,i)})});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],e):e(CodeMirror)}(function(e){"use strict";function t(e){e.state.tagHit&&e.state.tagHit.clear(),e.state.tagOther&&e.state.tagOther.clear(),e.state.tagHit=e.state.tagOther=null}function r(r){r.state.failedTagMatch=!1,r.operation(function(){if(t(r),!r.somethingSelected()){var i=r.getCursor(),n=r.getViewport();n.from=Math.min(n.from,i.line),n.to=Math.max(i.line+1,n.to);var a=e.findMatchingTag(r,i,n);if(a){if(r.state.matchBothTags){var o="open"==a.at?a.open:a.close;o&&(r.state.tagHit=r.markText(o.from,o.to,{className:"CodeMirror-matchingtag"}))}var l="close"==a.at?a.open:a.close;l?r.state.tagOther=r.markText(l.from,l.to,{className:"CodeMirror-matchingtag"}):r.state.failedTagMatch=!0}}})}function i(e){e.state.failedTagMatch&&r(e)}e.defineOption("matchTags",!1,function(n,a,o){o&&o!=e.Init&&(n.off("cursorActivity",r),n.off("viewportChange",i),t(n)),a&&(n.state.matchBothTags="object"==typeof a&&a.bothTags,n.on("cursorActivity",r),n.on("viewportChange",i),r(n))}),e.commands.toMatchingTag=function(t){var r=e.findMatchingTag(t,t.getCursor());if(r){var i="close"==r.at?r.open:r.close;i&&t.extendSelection(i.to,i.from)}}});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){e.defineOption("showTrailingSpace",!1,function(t,r,i){i==e.Init&&(i=!1),i&&!r?t.removeOverlay("trailingspace"):!i&&r&&t.addOverlay({token:function(e){for(var t=e.string.length,r=t;r&&/\s/.test(e.string.charAt(r-1));--r);return r>e.pos?(e.pos=r,null):(e.pos=t,"trailingspace")},name:"trailingspace"})})});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(e){var t=e.getWrapperElement();e.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:t.style.width,height:t.style.height},t.style.width="",t.style.height="auto",t.className+=" CodeMirror-fullscreen",document.documentElement.style.overflow="hidden",e.refresh()}function r(e){var t=e.getWrapperElement();t.className=t.className.replace(/\s*CodeMirror-fullscreen\b/,""),document.documentElement.style.overflow="";var r=e.state.fullScreenRestore;t.style.width=r.width,t.style.height=r.height,window.scrollTo(r.scrollLeft,r.scrollTop),e.refresh()}e.defineOption("fullScreen",!1,function(i,n,a){a==e.Init&&(a=!1),!a!=!n&&(n?t(i):r(i))})});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e,t,r,i){this.cm=e,this.node=t,this.options=r,this.height=i,this.cleared=!1}function r(e){var t=e.getWrapperElement(),r=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,i=parseInt(r.height),n=e.state.panels={setHeight:t.style.height,heightLeft:i,panels:0,wrapper:document.createElement("div")};t.parentNode.insertBefore(n.wrapper,t);var a=e.hasFocus();n.wrapper.appendChild(t),a&&e.focus(),e._setSize=e.setSize,null!=i&&(e.setSize=function(t,r){if(null==r)return this._setSize(t,r);if(n.setHeight=r,"number"!=typeof r){var a=/^(\d+\.?\d*)px$/.exec(r);a?r=Number(a[1]):(n.wrapper.style.height=r,r=n.wrapper.offsetHeight,n.wrapper.style.height="")}e._setSize(t,n.heightLeft+=r-i),i=r})}function i(e){var t=e.state.panels;e.state.panels=null;var r=e.getWrapperElement();t.wrapper.parentNode.replaceChild(r,t.wrapper),r.style.height=t.setHeight,e.setSize=e._setSize,e.setSize()}function n(e,t){for(var r=t.nextSibling;r;r=r.nextSibling)if(r==e.getWrapperElement())return!0;return!1}e.defineExtension("addPanel",function(e,i){i=i||{},this.state.panels||r(this);var a=this.state.panels,o=a.wrapper,l=this.getWrapperElement();i.after instanceof t&&!i.after.cleared?o.insertBefore(e,i.before.node.nextSibling):i.before instanceof t&&!i.before.cleared?o.insertBefore(e,i.before.node):i.replace instanceof t&&!i.replace.cleared?(o.insertBefore(e,i.replace.node),i.replace.clear()):"bottom"==i.position?o.appendChild(e):"before-bottom"==i.position?o.insertBefore(e,l.nextSibling):"after-top"==i.position?o.insertBefore(e,l):o.insertBefore(e,o.firstChild);var s=i&&i.height||e.offsetHeight;return this._setSize(null,a.heightLeft-=s),a.panels++,i.stable&&n(this,e)&&this.scrollTo(null,this.getScrollInfo().top+s),new t(this,e,i,s)}),t.prototype.clear=function(){if(!this.cleared){this.cleared=!0;var e=this.cm.state.panels;this.cm._setSize(null,e.heightLeft+=this.height),this.options.stable&&n(this.cm,this.node)&&this.cm.scrollTo(null,this.cm.getScrollInfo().top-this.height),e.wrapper.removeChild(this.node),0==--e.panels&&i(this.cm)}},t.prototype.changed=function(e){var t=null==e?this.node.offsetHeight:e,r=this.cm.state.panels;this.cm._setSize(null,r.heightLeft-=t-this.height),this.height=t}});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function t(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function r(e){t(e);var r=e.state.placeholder=document.createElement("pre");r.style.cssText="height: 0; overflow: visible",r.className="CodeMirror-placeholder";var i=e.getOption("placeholder");"string"==typeof i&&(i=document.createTextNode(i)),r.appendChild(i),e.display.lineSpace.insertBefore(r,e.display.lineSpace.firstChild)}function i(e){a(e)&&r(e)}function n(e){var i=e.getWrapperElement(),n=a(e);i.className=i.className.replace(" CodeMirror-empty","")+(n?" CodeMirror-empty":""),n?r(e):t(e)}function a(e){return 1===e.lineCount()&&""===e.getLine(0)}e.defineOption("placeholder","",function(r,a,o){var l=o&&o!=e.Init;if(a&&!l)r.on("blur",i),r.on("change",n),r.on("swapDoc",n),n(r);else if(!a&&l){r.off("blur",i),r.off("change",n),r.off("swapDoc",n),t(r);var s=r.getWrapperElement();s.className=s.className.replace(" CodeMirror-empty","")}a&&!r.hasFocus()&&i(r)})});!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t){t.state.rulerDiv.textContent="";var r=t.getOption("rulers"),i=t.defaultCharWidth(),n=t.charCoords(e.Pos(t.firstLine(),0),"div").left;t.state.rulerDiv.style.minHeight=t.display.scroller.offsetHeight+30+"px";for(var a=0;a<r.length;a++){var o=document.createElement("div");o.className="CodeMirror-ruler";var l,s=r[a];"number"==typeof s?l=s:(l=s.column,s.className&&(o.className+=" "+s.className),s.color&&(o.style.borderColor=s.color),s.lineStyle&&(o.style.borderLeftStyle=s.lineStyle),s.width&&(o.style.borderLeftWidth=s.width)),o.style.left=n+l*i+"px",t.state.rulerDiv.appendChild(o)}}e.defineOption("rulers",!1,function(e,r){e.state.rulerDiv&&(e.state.rulerDiv.parentElement.removeChild(e.state.rulerDiv),e.state.rulerDiv=null,e.off("refresh",t)),r&&r.length&&(e.state.rulerDiv=e.display.lineSpace.parentElement.insertBefore(document.createElement("div"),e.display.lineSpace),e.state.rulerDiv.className="CodeMirror-rulers",t(e),e.on("refresh",t))})});