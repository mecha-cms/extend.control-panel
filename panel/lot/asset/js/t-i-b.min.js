/*!
 * =======================================================
 *  SIMPLEST TAGS INPUT BEAUTIFIER 2.2.2
 * =======================================================
 *
 *   Author: Taufik Nurrohman
 *   URL: https://github.com/tovic
 *   License: MIT
 *
 * -- USAGE: ---------------------------------------------
 *
 *   var tags = new TIB(document.querySelector('input'));
 *
 * -------------------------------------------------------
 *
 */
!function(t,e,n){function r(t){return e.createElement(t)}function a(t){return Object.keys(t)}function i(t){return a(t).length}var s="__instance__",o=setTimeout,u="innerHTML",c="textContent",f="class",l=f+"Name",p=f+"es",g="toLowerCase",d="replace",v="pattern",h="placeholder",m="indexOf",k="firstChild",y="parentNode",f="Sibling",b="next"+f,j="previous"+f,w="appendChild",x="insertBefore",C="removeChild",f="Attribute",E="set"+f,D="get"+f,L="preventDefault",_="addEventListener",N="removeEventListener";!function(t){t.version="2.2.2",t[s]={},t.each=function(e,n){return o(function(){var n,r=t[s];for(n in r)e(r[n],n,r)},0===n?0:n||1),t}}(t[n]=function(e,f){function T(){I.focus()}function B(t){var e,n=t?this:I;o(function(){e=n[c].split(G.join);for(M in e)$.set(e[M])},1)}function K(){$.error=0,$.set(this[c])}function O(t){$.error=0;var e,n=this,r=t.keyCode,a=J,i=G.escape,s=(t.key||String.fromCharCode(r))[g](),f=t.ctrlKey,l=t.shiftKey,p=Q[j]&&Q[j][D](U),d=I[b],v="tab"===s||!l&&9===r,h="enter"===s||!l&&13===r,k=" "===s||!l&&32===r,w="backspace"===s||!l&&8===r;if(!f&&h&&-1===i[m]("\n")){for(;a=a[y];)if("form"===a.nodeName[g]()){e=a,t[L]();break}$.set(n[c]),0===$.error&&e&&e.submit()}else if(f&&("v"===s||!l&&86===r))B();else if(!n[c]&&w)$.reset(p),T();else{var x,C;for(M in i)if(x=i[M],C="s"===x,(C||"	"===x)&&v||(C||"\n"===x)&&h||(C||" "===x)&&k)return o(function(){$.set(n[c]),T()},1),void t[L]();o(function(){var t=n[c];for(d[u]=t?"":F,M=0,P=i.length;P>M;++M)if(i[M]&&-1!==t[m](i[M])){$.set(t.split(i[M]).join(""));break}},1)}}function R(){I[u]="",I[b][u]=F}function S(t){return e[l]=V+" "+G[p][3],J[l]=G[p][0]+" "+G[p][0]+"-"+z,J.id=G[p][0]+":"+(e.id||z),J[u]='<span class="'+G[p][4]+'"></span>',Q[l]=G[p][1]+" "+G[p][2],Q[u]='<span contenteditable spellcheck="false" style="white-space:nowrap;outline:none;"></span><span>'+F+"</span>",e[y][x](J,e[b]||null),J[k][w](Q),I=Q[k],J[_]("click",T,!1),e[_]("focus",T,!1),I[_]("blur",K,!1),I[_]("paste",B,!1),I[_]("keydown",O,!1),$.update(e.value.split(G.join),t),$}function q(){e[l]=V,J[y][C](J),J[N]("click",T),e[N]("focus",T),I[N]("blur",K),I[N]("paste",B),I[N]("keydown",O)}var A,H,I,M,P,$=this,z=Date.now(),F=e[D]("data-"+h)||e[h]||"",G={join:", ",max:9999,escape:[","],alert:!0,text:["Delete “%{tag}%”","Duplicate “%{tag}%”","Please match the requested format: %{pattern}%"],classes:["tags","tag","tags-input","tags-output","tags-view"],update:function(){}},J=r("span"),Q=r("span"),U="data-tag";t[n][s][e.id||e.name||i(t[n][s])]=$,f="string"==typeof f?{join:f}:f||{};for(M in f)G[M]=f[M];H=G[v]||e[D]("data-"+v),A=G.update,G[h]&&(F=G[h]),$.tags={},$.success=1,$.error=0,$.filter=function(t){return H?!t||RegExp(H).test(t)?t:!1:(t+"")[d](RegExp("["+G.join[d](/\s/g,"")+"]|[-\\s]{2,}|^\\s+|\\s+$","g"),"")[g]()},$.update=function(t,n){for(e.value="";(M=J[k][k])&&M[D](U);)J[k][C](M);if(0===t)t=a($.tags);else{for(M in t)P=$.filter(t[M]),P&&($.tags[P]=1);t=a($.tags)}$.tags={};for(M in t)$.set(t[M],n);return A.call($,$.tags),$},$.reset=function(t){return t=$.filter(t||""),t?delete $.tags[t]:$.tags={},$.update(0,1)},$.set=function(t,n){var s,o=G.alert,u=G.text;if(t=$.filter(t),t===!1)return R(),o&&($.error=2,s=(u[2]||t)[d](/%\{pattern\}%/g,H),"function"==typeof o?o.call($,s,t):alert(s)),$;if(""===t||i($.tags)>=G.max)return R(),$;var c,f=r("span"),g=r("a");return f[l]=G[p][1],f[E](U,t),g.href="javascript:;",g.title=(u[0]||"")[d](/%\{tag\}%/g,t),g[_]("click",function(t){var e=this,n=e[y],r=e[y][D](U);n[y][C](n),$.reset(r),T(),t[L]()},!1),f[w](g),R(),(c=$.tags[t])?n?J[k][x](f,Q):o&&($.error=1,s=(u[1]||t)[d](/%\{tag\}%/g,t),"function"==typeof o?o.call($,s,c):alert(s)):($.tags[t]=f,J[k][x](f,Q)),e.value=a($.tags).join(G.join),!n&&A.call($,$.tags),$};var V=e[l];S.call($,1),$.create=function(){return S.call($,1)},$.destroy=function(){return q.call($)},$.config=G,$.input=Q,$.self=J,$.source=$.output=e})}(window,document,"TIB");