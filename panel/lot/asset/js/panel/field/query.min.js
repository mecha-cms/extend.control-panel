/*!
 * ==============================================================
 *  TAG PICKER 3.0.7
 * ==============================================================
 * Author: Taufik Nurrohman <https://github.com/taufik-nurrohman>
 * License: MIT
 * --------------------------------------------------------------
 */
!function(t,n,e){function r(t,n){var e=n[M](t);return 0>e?null:e}function u(t,n){return t[O].remove(n)}function i(t,n){return t[O].add(n)}function a(t){return Object.keys(t).length}function o(t,n){return Object.assign(t,n)}function c(t,n){return n[M](t)>=0}function f(t){return"function"==typeof t}function s(t){return"number"==typeof t}function l(t){return void 0!==t}function v(t){return"string"==typeof t}function p(t){g(t)&&t[z][q](t)}function g(t){return t&&t[z]}function d(t,e,r){var u,i,a=v(t)?n[S](t):t;if((e||""===e)&&(a[A]=e),r)for(u in r)i=r[u],null===i||!1===i?a[W](u):a[P](u,i);return a}var m="Arrow",b=m+"Left",h=m+"Right",$="Backspace",y="Delete",w="Enter",x="Tab",k="__instance__",E="appendChild",_="children",O="classList",S="createElement",T="ctrlKey",j="disabled",R="firstChild",L="forEach",C="getAttribute",M="indexOf",A="innerHTML",N="insertBefore",K="key",D=K+"Code",I="nextSibling",H="nodeName",z="parentNode",X="previousSibling",Y="readOnly",W="removeAttribute",q="removeChild",B="replace",P="setAttribute",J="shiftKey",F="textContent",G="toLowerCase",Q=setTimeout;!function(t){t.version="3.0.7",t[k]={},t.each=function(n,e){var r,u;return Q(function(){u=t[k];for(r in u)n.call(u[r],r)},0===e?0:e||1),t},t.I={"Maximum tags allowed is %d":"Maximum tags allowed is %d.","Minimum tags allowed is %d":"Minimum tags allowed is %d.","Remove tag %s":"Remove tag “%s”","Tag %s already exists":"Tag “%s” already exists."},t.i=function(n,e){return n=t.I[n]||n,e&&e[L](function(t){n=n[B]("%"+(s(t)?"d":"s"),t)}),n},t._=t.prototype}(t[e]=function(n,g){function m(t,n,e){return l(Rn[t])||(Rn[t]={}),l(e)||(e=a(Rn[t])),Rn[t][e]=n,En}function O(t,n){return l(t)?l(n)?(delete Rn[t][n],En):(Rn[t]={},En):(Rn={},En)}function S(t,n,e){if(!l(Rn[t]))return En;if(l(e))l(Rn[t][e])&&Rn[t][e].apply(En,n);else for(var r in Rn[t])Rn[t][r].apply(En,n);return En}function M(t){return En.f(t)[B](RegExp("("+Ln.escape.join("|")[B](/\\/g,"\\\\")+")+"),"").trim()}function W(t){if(n[j]||n[Y])return ln("");var e,r=M(Nn[F]);r&&(dn(r)?t&&sn("Tag %s already exists",[r]):(hn(r),bn(r),e=En.tags.length,S("change",[r,e]),S("set.tag",[r,e])),ln(""))}function q(){W(1),u(Cn,"focus"),u(Cn,"focus.input"),S("blur",[kn,En.tags.length])}function P(){S("click",[En.tags])}function U(){i(Cn,"focus"),i(Cn,"focus.input"),S("focus",[En.tags])}function V(t){var e,r=Ln.escape,i=t[D],a=t[K],o=t[T],f=w===a||13===i,s=t[J],l=x===a||9===i,v=An[X],p=En.tags.length,g=Ln.max,d=M(Nn[F]);f?a="\n":l&&(a="	"),l||(n[j]||n[Y]?(f&&n[Y]&&yn(),gn(t)):c(a,r)||c(i,r)?(g>p?W(1):(ln(""),sn("Maximum tags allowed is %d",[g])),gn(t)):f?(yn(),gn(t)):Q(function(){var n=Nn[F],f=M(n);c(n.slice(-1),r)?(g>p?W(1):(ln(""),sn("Maximum tags allowed is %d",[g])),gn(t)):""!==f||o||s||(""!==d||$!==a&&8!==i?(b===a||37===i)&&v&&v.focus():(e=En.tags[p-1],u(Cn,"focus.tag"),$n(e),mn(e),v&&(S("change",[e,p-1]),S("let.tag",[e,p-1])))),Kn[A]=f?"":On},0))}function Z(t){if(Cn[z])for(var e;e=An[X];)$n(e.title);for(En.tags=[],n.value="",t=t?t.split(Ln.join):[],xn=Ln.max,wn=0;xn>wn&&t[wn];++wn)if(""!==(kn=M(t[wn]))){if(dn(kn))continue;hn(kn),bn(kn),S("change",[kn,wn]),S("set.tag",[kn,wn])}}function tn(t){if(!n[j]){var e=Ln.min;return W(),e>0&&En.tags.length<e?(ln("",1),sn("Minimum tags allowed is %d",[e]),void gn(t)):1}}function nn(){Q(function(){n[j]||n[Y]||Z(Nn[F]),ln("")},0)}function en(t){t&&Cn===t.target&&(Nn.focus(),P())}function rn(){Nn.focus()}function un(){var t=this,n=t.title;u(Cn,"focus"),u(Cn,"focus.tag"),S("blur.tag",[n,r(n,En.tags)])}function an(){var t=this.title;S("click.tag",[t,r(t,En.tags)])}function on(){var t=this,n=t.title;i(Cn,"focus"),i(Cn,"focus.tag"),S("focus.tag",[n,r(n,En.tags)])}function cn(t){if(!n[j]&&!n[Y]){var e=this[z].title;$n(e),mn(e),ln("",1)}gn(t)}function fn(t){var e=this,i=t[D],a=t[K],o=(t[T],n[Y]),c=(t[J],e[X]),f=e[I];if(o||b!==a&&37!==i)if(o||h!==a&&39!==i){if($===a||y===a||8===i||46===i){if(!o){var s=e.title,l=r(s,En.tags);u(Cn,"focus.tag"),$n(s),mn(s),$===a||8===i?c?c.focus():ln("",1):f&&f!==An?f.focus():ln("",1),S("change",[s,l]),S("let.tag",[s,l])}gn(t)}}else f&&f!==An?f.focus():ln("",1),gn(t);else c&&(c.focus(),gn(t))}function sn(t,n){var e,r=Ln.alert;!0===r&&(e=_n.i(t,n))?alert(e):f(r)?r.apply(En,n):v(r)&&_n[r]&&_n[r].apply(En,n)}function ln(t,n){Nn[F]=t,Kn[F]=t?"":On,n&&Nn.focus()}function vn(t,n,e){t.removeEventListener(n,e)}function pn(t,n,e){t.addEventListener(n,e,!1)}function gn(t){t&&t.preventDefault()}function dn(t,n){var e=r(t,En.tags);return n&&S("get.tag",[t,e]),s(e)?t:null}function mn(t){var e=r(t,En.tags);return s(e)&&e>=0?(En.tags.splice(e,1),n.value=En.tags.join(Ln.join),!0):!1}function bn(t,e){s(e)?(e=0>e?0:e,En.tags.splice(e,0,t)):En.tags.push(t),n.value=En.tags.join(Ln.join)}function hn(t,e){var r=d("span",0,{"class":"tag",tabindex:n[j]?!1:"0",title:t});if(Ln.x){var u=d("a",0,{href:"",tabindex:"-1",title:_n.i("Remove tag %s",[t])});pn(u,"click",cn),r[E](u)}pn(r,"blur",un),pn(r,"click",an),pn(r,"focus",on),pn(r,"keydown",fn),Mn[z]&&(s(e)&&En.tags[e]?Mn[N](r,Mn[_][e]):Mn[N](r,An))}function $n(t){var n,e=r(t,En.tags);if(s(e)&&e>=0&&(n=Mn.children[e])){if(vn(n,"blur",un),vn(n,"click",an),vn(n,"focus",on),vn(n,"keydown",fn),Ln.x){var u=n[R];vn(u,"click",cn),p(u)}p(n)}}function yn(){tn()&&jn&&jn.submit()}if(n){var wn,xn,kn,En=this,_n=t[e],On=n.placeholder||"",Sn=n[C]("tabindex"),Tn={alert:!0,"class":"tag-picker",escape:[",",188],join:", ",max:9999,min:0,x:!1};if(n[e])return En;if(!(En instanceof _n))return new _n(n,g);_n[k][n.id||n.name||a(_n[k])]=En,n[e]=1,v(g)&&(g={join:g});var jn,Rn={},Ln=o(Tn,g),Cn=d("span",0,{"class":Ln["class"]}),Mn=d("span",0,{"class":"tags"}),An=d("span",0,{"class":"editor tag"}),Nn=d("span",0,{contenteditable:n[j]?!1:"true",spellcheck:"false",style:"white-space:pre;"}),Kn=d("span");for(En.f=function(t){return t[G]()[B](/[^ a-z0-9-]/g,"")},ln(""),i(n,Ln["class"]+"-source"),n[z][N](Cn,n[I]),Cn[E](Mn),Mn[E](An),An[E](Nn),An[E](Kn),d(n,0,{tabindex:"-1"}),jn=n[z];jn&&jn[H]&&"form"!==jn[H][G]();)jn=jn[z];pn(Nn,"blur",q),pn(Nn,"click",P),pn(Nn,"focus",U),pn(Nn,"keydown",V),pn(Nn,"paste",nn),pn(n,"focus",rn),pn(Cn,"click",en),jn&&pn(jn,"submit",tn),En.tags=[],Z(n.value),En.input=Nn,En.self=En.view=Cn,En.source=En.output=n,En.state=Ln,En.blur=function(){return!n[j]&&(Nn.blur(),q()),En},En.click=function(){return Cn.click(),en(),En},En.fire=function(t,n,e){return S(t,n,e)},En.focus=function(){return n[j]||(Nn.focus(),U()),En},En.get=function(t){return n[j]?null:dn(t,1)},En.let=function(t,e){if(!n[j]&&!n[Y]){var r=Ln.min;if(W(),e&&r>0&&En.tags.length<r)return sn("Minimum tags allowed is %d",[r]),En;$n(t),mn(t)}return En},En.on=function(t,n,e){return m(t,n,e)},En.off=function(t,n){return O(t,n)},En.pop=function(){return n[e]?(delete n[e],vn(Nn,"blur",q),vn(Nn,"click",P),vn(Nn,"focus",U),vn(Nn,"keydown",V),vn(Nn,"paste",nn),vn(n,"focus",rn),vn(Cn,"click",en),jn&&vn(jn,"submit",tn),En.tags[L]($n),u(n,Ln["class"]+"-source"),d(n,0,{tabindex:Sn}),p(Cn),S("pop")):En},En.set=function(t,e,r){if(!n[j]&&!n[Y])if(dn(t))r&&sn("Tag %s already exists",[t]);else{var u=Ln.max;En.tags.length<u?(hn(t,e),bn(t,e)):r&&sn("Maximum tags allowed is %d",[u])}return En},En.value=function(t){return!n[j]&&!n[Y]&&Z(t),En}}})}(window,document,"TP"),function(t){var n,e,r=t.querySelectorAll(".field\\:query .input");r.length&&r.forEach(function(t){e=t.className,n=new TP(t,JSON.parse(t.getAttribute("data-state")||"{}")),n.view.className+=" "+e})}(document);